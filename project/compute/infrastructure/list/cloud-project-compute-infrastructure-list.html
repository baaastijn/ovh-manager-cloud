<div class="text-center" style="margin-top: 200px;"
     data-ng-if="ComputeInfrastructureListCtrl.loaders.init">
    <oui-spinner size="l" inline="true"></oui-spinner>
</div>
<div data-ng-hide="ComputeInfrastructureListCtrl.loaders.init">
    <div class="row">
        <div class="col-xs-3">
            <div class="btn-group cloud-compute-infra-primary-actions">
                <button type="button" class="oui-button oui-button_dropdown dropdown-toggle mb-0" aria-haspopup="true" aria-expanded="false"
                        data-ng-disabled="ComputeInfrastructureDiagramCtrl.loaders.vRack"
                        data-toggle="dropdown"
                        write-right-required>
                    <span data-ng-bind=":: 'common_actions' | translate"></span>
                    <span class="oui-icon oui-icon-chevron-down" aria-hidden="true"></span>
                </button>
                <ul class="dropdown-menu mt-0">
                    <li>
                        <button type="button" class="btn fs14"
                                data-ng-click="ComputeInfrastructureListCtrl.InfrastructureService.openDeleteProjectModal()"
                                at-internet-click="{ name : 'cloud-project::cloud-project-compute::cloud-project-compute-infrastructure-delete-project' }"
                                data-ng-bind=":: 'cpb_details_project_delete' | translate"
                                write-right-required>
                        </button>
                    </li>
                </ul>
            </div>
        </div>
        <div class="col-xs-9 text-right">
            <div class="d-inline-block">
            <span class="oui-label align-middle d-inline-block mr-3"
                  data-translate="cpci_menu_view_label"></span>
                <nav class="oui-button-group align-middle mb-0">
                    <a class="oui-button oui-button_secondary"
                       ui-sref="iaas.pci-project.compute.infrastructure.diagram()"
                       data-translate="cpci_menu_view_diagram"></a>
                    <a class="oui-button oui-button_primary"
                       ui-sref="iaas.pci-project.compute.infrastructure.list()"
                       data-translate="cpci_menu_view_list"></a>
                </nav>
            </div>
        </div>
    </div>
    <section class="row cui-page__content">
        <oui-datagrid data-rows="ComputeInfrastructureListCtrl.table.items" data-page-size="10">
            <oui-column title="'cpci_vm_name' | translate" property="name" sortable>
                <span data-ng-bind="$row.name"></span>
            </oui-column>
            <oui-column title="'cpci_vm_region' | translate" property="region" sortable>
                <span data-ng-bind="ComputeInfrastructureListCtrl.RegionService.getTranslatedMicroRegion($row.region)"></span>
            </oui-column>
            <oui-column title="'cpci_vm_flavor_category' | translate" property="flavor">
                <span data-translate="cpci_vm_flavor_category_{{ $row.flavor.name }}"
                      data-translate-default="?"></span>
            </oui-column>
            <oui-column title="'ipv4'">{{ $row.getPublicIpv4() }}</oui-column>
            <oui-column title="'ipv6'">{{ $row.getPublicIpv6() }}</oui-column>
            <oui-column title="'cpci_vm_hdd' | translate" property="volumes">
                <span data-ng-bind="$row.volumes.length"
                      data-ng-if="$row.volumes.length === 0 || $row.volumes.length"></span>
                <span data-ng-bind="$row.volumes[0].name + ' (' + ($row.volumes[0].size | bytes:2:true:'GiB') + ')'"
                      data-ng-if="$row.volumes.length === 1"></span>
            </oui-column>
            <oui-column title="'cpci_vm_price' | translate" property="price">
                <span data-ng-if="$row.status !== 'DRAFT' && $row.monthlyBilling.status !== 'ok'"
                      data-translate="cpci_vm_flavor_price"
                      data-translate-values="{ price: $row.price.price.text || '?' }">
                </span>
                <span data-ng-if="$row.status !== 'DRAFT' && $row.monthlyBilling.status === 'ok'"
                      data-translate="cpci_vm_flavor_month"
                      data-translate-values="{ price: $row.price.price.text || '?' }">
                </span>
                <oui-spinner size="s" inline="true"
                             data-ng-if="$row.monthlyBilling.status === 'activationPending'"></oui-spinner>
            </oui-column>
            <oui-action-menu data-align="end" data-compact>
                <oui-action-menu-item data-text="{{ 'cpci_vm_action_delete' | translate }}"
                                      data-on-click="$row.confirm = 'deleteConfirmPending'"
                                      data-ng-if="$row.status === 'DRAFT'">
                </oui-action-menu-item>
                <oui-action-menu-item data-text="{{ 'cpci_vm_action_monthly' | translate }}"
                                      data-on-click="ComputeInfrastructureListCtrl.InfrastructureService.openMonthlyConfirmation($row)"
                                      data-ng-if="$row.status === 'ACTIVE'">
                </oui-action-menu-item>
                <oui-action-menu-item data-text="{{ 'cpci_vm_action_create_snapshot' | translate }}"
                                      data-on-click="ComputeInfrastructureListCtrl.InfrastructureService.openSnapshotWizard($row)"
                                      data-ng-if="$row.status === 'ACTIVE'">
                </oui-action-menu-item>
                <oui-action-menu-divider data-ng-if="$row.status === 'ACTIVE'"></oui-action-menu-divider>
                <oui-action-menu-item data-text="{{ 'cpci_vm_action_auth_info' | translate }}"
                                      data-on-click="ComputeInfrastructureListCtrl.InfrastructureService.openLoginInformations($row)"
                                      data-ng-if="$row.status === 'ACTIVE'">
                </oui-action-menu-item>
                <oui-action-menu-item data-text="{{ 'cpci_vm_action_vnc' | translate }}"
                                      data-on-click="ComputeInfrastructureListCtrl.InfrastructureService.openVnc($row)"
                                      data-ng-if="$row.status === 'ACTIVE' || ($row.status === 'RESCUE' && $row.getStatusGroup() === 'OPENSTACK')">
                </oui-action-menu-item>
                <oui-action-menu-divider data-ng-if="$row.status === 'ACTIVE'"></oui-action-menu-divider>
                <oui-action-menu-item data-text="{{ 'cpci_vm_action_rescue' | translate }}"
                                      data-on-click="ComputeInfrastructureListCtrl.InfrastructureService.rescueMode($row)"
                                      data-ng-if="$row.status === 'ACTIVE'">
                </oui-action-menu-item>
                <oui-action-menu-divider data-ng-if="$row.status === 'ACTIVE'"></oui-action-menu-divider>
                <oui-action-menu-item data-text="{{ 'cpci_vm_action_reboot' | translate }}"
                                      data-on-click="ComputeInfrastructureListCtrl.InfrastructureService.rebootVirtualMachine($row, 'soft')"
                                      data-ng-if="$row.status === 'ACTIVE'">
                </oui-action-menu-item>
                <oui-action-menu-item data-text="{{ 'cpci_vm_action_reboot_hard' | translate }}"
                                      data-on-click="ComputeInfrastructureListCtrl.InfrastructureService.rebootVirtualMachine($row, 'hard')"
                                      data-ng-if="$row.status === 'ACTIVE'">
                </oui-action-menu-item>
                <oui-action-menu-divider data-ng-if="$row.status === 'ACTIVE'"></oui-action-menu-divider>
                <oui-action-menu-item data-text="{{ 'cpci_vm_action_reinstall' | translate }}"
                                      data-on-click="ComputeInfrastructureListCtrl.InfrastructureService.reinstallVirtualMachine($row)"
                                      data-ng-if="$row.status === 'ACTIVE'">
                </oui-action-menu-item>

                <oui-action-menu-item data-text="{{ 'cpci_vm_action_rescue_end' | translate }}"
                                      data-on-click="ComputeInfrastructureListCtrl.InfrastructureService.stopRescueMode($row, false)"
                                      data-ng-if="$row.status === 'RESCUE' && $row.getStatusGroup() === 'OPENSTACK'">
                </oui-action-menu-item>
                <oui-action-menu-item data-text="{{ 'cpci_vm_action_resume' | translate }}"
                                      data-on-click="ComputeInfrastructureListCtrl.InfrastructureService.resumeVirtualMachine($row)"
                                      data-ng-if="$row.status === 'SUSPENDED' && $row.getStatusGroup() === 'OPENSTACK'">
                </oui-action-menu-item>
                <oui-action-menu-divider data-ng-if="$row.status === 'RESCUE' || $row.status === 'SUSPENDED'"></oui-action-menu-divider>
                <oui-action-menu-item data-text="{{ 'cpci_vm_action_delete' | translate }}"
                                      data-on-click="ComputeInfrastructureListCtrl.InfrastructureService.removeVirtualMachine($row)">
                </oui-action-menu-item>
            </oui-action-menu>
        </oui-datagrid>
    </section>
</div>
